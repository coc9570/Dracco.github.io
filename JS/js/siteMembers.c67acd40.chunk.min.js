(self.webpackJsonp__wix_thunderbolt_app=self.webpackJsonp__wix_thunderbolt_app||[]).push([[4522],{31857:function(e,o,i){"use strict";i.r(o),i.d(o,{AUTH_RESULT_REASON:function(){return y.$9},BIEvents:function(){return T},INTERACTIONS:function(){return y.SE},PrivacyStatus:function(){return y.iY},SiteMembersApiSymbol:function(){return w.n9},isLoginAcceptableError:function(){return k.Y2},isSignupAcceptableError:function(){return k.fJ},memberDetailsFromDTO:function(){return k.Ky},page:function(){return j},site:function(){return $}});var t=i(43757),n=i(31191),s=i(61049),a=i(49574),r=i(5096),l=i(55048),d=i(98333),u=i(10666),c=i(58629),m=i(26513),g=i(82627),p=i(8562),h=i(56405),v=i(19238),b=i(87821),S=i(23228),f=i(99552),C=i(16684),y=i(95848),D=i(51831),w=i(2811);class P{constructor(e,o,i,t){this.propsStore=e,this.structureApi=o,this.siteScrollBlocker=i,this.browserWindow=t}displayDialog(e,o,i,t={}){return(0,n.mG)(this,void 0,void 0,(function*(){const s=()=>(0,n.mG)(this,void 0,void 0,(function*(){(0,p.yF)(this.browserWindow)||(this.activeElementBeforeShowDialog=this.browserWindow.document.activeElement);const t=(0,C.uniqueId)(w.rj);this.propsStore.update({[t]:Object.assign(Object.assign({},o),i)}),(0,D.U)(),yield this.structureApi.addComponentToDynamicStructure(t,{componentType:e,components:[]}),this.currentCompId&&(this.structureApi.removeComponentFromDynamicStructure(this.currentCompId),this.siteScrollBlocker.setSiteScrollingBlocked(!1,this.currentCompId)),this.siteScrollBlocker.setSiteScrollingBlocked(!0,t),this.currentCompId=t})),{shouldWaitForAppDidMount:a,registerToAppDidMount:r}=t;a&&r?r(s):yield s()}))}hideDialog(){var e;this.currentCompId&&(this.structureApi.removeComponentFromDynamicStructure(this.currentCompId),this.siteScrollBlocker.setSiteScrollingBlocked(!1,this.currentCompId),(0,D.i)()),this.currentCompId=void 0,(0,p.yF)(this.browserWindow)||(null===(e=this.activeElementBeforeShowDialog)||void 0===e||e.focus(),this.activeElementBeforeShowDialog=null)}}var k=i(43096),E=i(42473);const T=({sessionManager:e,businessLogger:o,wixBiSession:i,viewMode:t,language:n})=>{const s=(o,s)=>({biToken:i.msId,context:o,ts:L(i),viewmode:t,visitor_id:e.getVisitorId(),site_member_id:e.getSiteMemberId(),vsi:i.viewerSessionId,site_settings_lng:n.siteLanguage,browser_lng:n.userLanguage,lng_mismatch:n.siteLanguage!==n.userLanguage,layout:s});return{loginOrSignUpDialogLoaded:(e,i="fullscreen")=>{o.logger.log(Object.assign({src:5,evid:658},s(e,i)),{endpoint:"site-members"})},closingDialog:(e,i="fullscreen")=>{o.logger.log(Object.assign({src:5,evid:602,form_type:"default"},s(e,i)),{endpoint:"site-members"})},emailAuthSubmitClicked:(e,i)=>{o.logger.log(Object.assign({src:5,evid:603,form_type:"default"},s(e,i)),{endpoint:"site-members"})},siteMembersFeatureLoaded:()=>{o.logger.log(Object.assign({src:5,evid:698},s()),{endpoint:"site-members"})},siteMembersSdkFeatureLoaded:()=>{o.logger.log(Object.assign({src:5,evid:699},s()),{endpoint:"site-members"})}}},L=e=>{const o=e.initialTimestamp||0;return Date.now()-o};class A{constructor(e){this.shouldRunCustomPopupCloseCallback=!0,this.popups=e,this.config={isCloseable:!0,returnPages:!1}}openPopupPage(e,o){var i;return(0,n.mG)(this,void 0,void 0,(function*(){const t=this.shouldRunCustomPopupCloseCallback;this.shouldRunCustomPopupCloseCallback=!1,yield null===(i=this.popups)||void 0===i?void 0:i.openPopupPage(e,(()=>{this.shouldRunCustomPopupCloseCallback&&(this.rejectAuthenticationRequest(),o&&o())})),this.shouldRunCustomPopupCloseCallback=t}))}preventCustomPopupCloseCallback(){this.shouldRunCustomPopupCloseCallback=!1}allowCustomPopupCloseCallback(){this.shouldRunCustomPopupCloseCallback=!0}assignRequestAuthenticationRejection(e){this.requestAuthenticationRejection=this.requestAuthenticationRejection||e}assignRequestAuthenticationResolveInstance(e){this.requestAuthenticationResolveInstance=this.requestAuthenticationResolveInstance||e}rejectAuthenticationRequest(){this.requestAuthenticationRejection&&(this.requestAuthenticationRejection(y.$9.CANCELED),this.requestAuthenticationRejection=void 0)}setConfig({isCloseable:e=!0,returnPages:o=!1}){this.config={isCloseable:e,returnPages:o}}reset(){this.requestAuthenticationRejection=void 0,this.requestAuthenticationResolveInstance=void 0,this.config={isCloseable:!0,returnPages:!1}}}const I=(e,o,i)=>{document.cookie=`${e}=;max-age=0`,document.cookie=`${e}=;max-age=0;path=${o}`,document.cookie=`${e}=;domain=${i};max-age=0`,document.cookie=`${e}=;domain=${i};max-age=0;path=${o}`},R=(0,t.ff)([(0,t.t6)(s.R9,w.u2),(0,t.t6)(s.jC,w.u2),(0,t.t6)(s.Wf,w.u2),a.U,r.EE,r.Zr,h.X,l.xP,l.QZ,r.bk,r.ZQ,v.F0,b.x,d.v,v.Iz,u.$,c.s,(0,t.jt)(S.r_),(0,t.jt)(f.I),m.jj,g.O,(0,t.jt)(E.I)],((e,o,i,t,s,a,r,l,d,u,c,m,g,h,v,b,S,f,D={trackEvent:()=>0},w,E,L)=>{var R,_;const{collectionExposure:M,smcollectionId:O,smSessionCookie:N,protectedHomepage:U,isCommunityInstalled:G,memberInfoAppId:$,isTemplate:j}=e;let{sm_efCookie:F}=e;const q="WixInternal"===M,W=r.getUserSession(),x=r.getAppInstanceByAppDefId("22bef345-3c5b-4c18-b782-74d4085112ff"),B=null!==(R=r.getVisitorId())&&void 0!==R?R:"00000000-0000-0000-0000-000000000000",{smSettings:V,tpaApplicationIds:K,policyLinks:Y}=o,H=$&&K[$],{siteRevision:z,metaSiteId:J,siteId:X,externalBaseUrl:Q}=a.site,Z=a.requestUrl,ee=a.viewMode,oe=-1!==y.F0.findIndex((e=>{var o,i;return null===(i=null===(o=null==c?void 0:c.navigator)||void 0===o?void 0:o.userAgent)||void 0===i?void 0:i.includes(e)})),ie=!oe,te=!oe,ne=`/_api/wix-sm-webapp/tokens/verify/${J}/${X}`,se=`${Q.replace(/\/$/,"")}/api/wix-sm/v1/authorize/${X}/pages`,ae=`/_api/wix-sm-webapp/tokens/logout/${J}`,re=`/_api/wix-sm-webapp/member/changePasswordWithMailToken?metaSiteId=${J}&collectionId=${O}`,le=`/_api/wix-sm-webapp/social/token/handle?metaSiteId=${J}&collectionId=${O}`,de=V.smFirstDialogLogin?"login":"signup",{socialLoginFacebookEnabled:ue,socialLoginGoogleEnabled:ce,termsOfUse:me,privacyPolicy:ge,codeOfConduct:pe,customSignUpPageId:he,customSignInPageId:ve}=V,be=null===(_=V.joinCommunityCheckedByDefault)||void 0===_||_;let{smToken:Se}=e,fe={},Ce=N,ye=null,De=!1;const we=e=>{ye=e},Pe=()=>({registerToAppDidMount:we,shouldWaitForAppDidMount:!De}),ke={},Ee={},Te=T({sessionManager:r,businessLogger:b,wixBiSession:S,viewMode:null==ee?void 0:ee.toUpperCase(),language:u});Te.siteMembersFeatureLoaded();const Le={},Ae=(0,k.Qn)(t,{credentials:"same-origin",headers:{accept:"application/json","x-wix-site-revision":`${z}`,"x-wix-client-artifact-id":"thunderbolt"}},a.requestUrl),Ie=((e,o,i,t)=>new P(e,o,i,t))(l,d,g,c),Re=E["specs.thunderbolt.sm_googleAuthViaSDK"],_e=new A(f),Me=(null==L?void 0:L.getBsi())||"00000000-0000-0000-0000-000000000000",Oe={appDidMount(){ye&&ye(),De=!0},login(e,o,i,t=!1){return(0,n.mG)(this,void 0,void 0,(function*(){D.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Log in Submit",eventLabel:"Wix"}});try{const n=yield Oe.performLogin(e,o,i),s=yield Oe.handleLoginResponse(n,t);return D.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Log in Success",eventLabel:"Wix"}}),s}catch(e){throw D.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Log in Failure",eventLabel:"Wix"}}),e}}))},performLogin(e,o,i){var t;return(0,n.mG)(this,void 0,void 0,(function*(){const n=yield Ae("/_api/wix-sm-webapp/v1/auth/login",{method:"POST",headers:{"Content-Type":"application/json",authorization:x||""},body:JSON.stringify({email:e,password:o,recaptchaToken:null==i?void 0:i.recaptchaToken})});return{member:n.member,token:null===(t=null==n?void 0:n.session)||void 0===t?void 0:t.token}}))},handleOauthToken(e,o,i,t,a=!1){return(0,n.mG)(this,void 0,void 0,(function*(){const n=r.getVisitorId();s.interactionStarted(y.SE.SOCIAL_APP_LOGIN),D.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Log in Submit",eventLabel:o}});const{errorCode:l,payload:d}=yield Ae(le,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({svSession:W,visitorId:n,token:e,provider:o,mode:i,lang:u.userLanguage,privacyStatus:t})});if(l)throw D.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Log in Failure",eventLabel:o}}),l;let c,m;s.interactionEnded(y.SE.SOCIAL_APP_LOGIN),d.smSession&&(m=d.smSession.siteMemberDto,c=d.smSession.sessionToken),m=d.siteMemberDto;const g=(0,k.Ky)(m),p=yield Oe.handleLoginResponse({member:g,token:c},a);return D.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Log in Success",eventLabel:o}}),p}))},handleSocialLoginResponse(e,o,i=!1){return(0,n.mG)(this,void 0,void 0,(function*(){let t,n;s.interactionStarted(y.SE.SOCIAL_APP_LOGIN),s.interactionEnded(y.SE.SOCIAL_APP_LOGIN),D.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Log in Submit",eventLabel:o}}),e.smSession&&(n=e.smSession.siteMemberDto,t=e.smSession.sessionToken),n=e.siteMemberDto;const a=(0,k.Ky)(n),r=yield Oe.handleLoginResponse({member:a,token:t},i);return D.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Log in Success",eventLabel:o}}),r}))},handleLoginResponse({token:e,member:o},i=!1){return(0,n.mG)(this,void 0,void 0,(function*(){const t=o.emailVerified;if(e||t||"ACTIVE"!==o.status){if(e){const t=yield Oe.applySessionToken(e,o,i);return Object.assign({sessionToken:e,member:o},i?{pages:t}:{})}{const e=yield h();return yield Oe.showNotificationDialog("",`${e("siteMembersTranslations","SMApply_Success1","Success! Your member signup request has been sent and is awaiting approval.")} ${e("siteMembersTranslations","SMApply_Success2","The site administrator will notify you via email ({0}) once your request has been approved.")}`.replace("{0}",o.loginEmail),e("siteMembersTranslations","SMContainer_OK","OK")),(0,k.Y_)()}}return yield Oe.showConfirmationEmailDialog(o.id),(0,k.Y_)()}))},promptLogin(e,o,i){var t,s,a,r;return void 0===e&&(e={}),void 0===o&&(o=null===(s=null===(t=_e.config)||void 0===t?void 0:t.isCloseable)||void 0===s||s),void 0===i&&(i=null!==(r=null===(a=_e.config)||void 0===a?void 0:a.returnPages)&&void 0!==r&&r),(0,n.mG)(this,void 0,void 0,(function*(){const{mode:t,modal:n}=e,s=null!=t?t:de,a=n?"popup":"fullscreen";if(j){const e=yield h();return yield Oe.showNotificationDialog(e("siteMembersTranslations","siteMembersTranslations_TEMPLATE_NOTIFICATION_TITLE","Demo Mode"),e("siteMembersTranslations","siteMembersTranslations_TEMPLATE_NOTIFICATION_MESSAGE","To make this template yours, start editing it."),e("siteMembersTranslations","SMContainer_OK","OK")),Promise.reject(y.$9.CANCELED)}return"login"===s?Oe.showLoginDialog(o,a,i):Oe.showSignUpDialog(o,a,i)}))},promptForgotPassword:(e=!0)=>new Promise(((o,i)=>{_e.assignRequestAuthenticationRejection(i);const t={isCloseable:e},s={onCloseDialogCallback(){Te.closingDialog("RequestResetPassword"),Ie.hideDialog(),_e.rejectAuthenticationRequest()},onSubmitCallback(e){return Oe.sendForgotPasswordMail(e).then((()=>(0,n.mG)(this,void 0,void 0,(function*(){const e=yield h();Oe.showNotificationDialog(e("siteMembersTranslations","siteMembersTranslations_RESET_PASSWORD_CHECKEMAIL_TITLE","Please Check Your Email"),e("siteMembersTranslations","siteMembersTranslations_RESET_PASSWORD_CHECKEMAIL_TEXT","We\u2019ve emailed you a link to reset your password."),e("siteMembersTranslations","siteMembersTranslations_Reset_Password_OK","Got It")),o()}))))}},a=E["specs.thunderbolt.smModalsShouldWaitForAppDidMount"]?Pe():{};Ie.displayDialog("RequestPasswordResetDialog",t,s,a)})),requestAuthentication(e={}){return(0,n.mG)(this,void 0,void 0,(function*(){if(Ce)return{success:!0,token:Ce,reason:y.$9.ALREADY_LOGGED_IN};try{const o=!U,{sessionToken:i}=yield Oe.promptLogin(e,o);return{success:!0,token:i,reason:y.$9.SUCCESS}}catch(e){return{success:!1,reason:e}}}))},requestAuthorizedPages(e={}){return(0,n.mG)(this,void 0,void 0,(function*(){if(Se){return{success:!0,pages:yield Oe.authorizeMemberPagesBySignedInstance(Se)}}try{const o=!U;_e.setConfig({isCloseable:o,returnPages:!0});const i=yield Oe.promptLogin(e,o,!0);return _e.reset(),{success:!0,pages:i.pages}}catch(e){return{success:!1,reason:e}}}))},applySessionToken(e,o,i=!1){return(0,n.mG)(this,void 0,void 0,(function*(){s.interactionStarted(y.SE.VERIFY_TOKEN);const{payload:t,errorCode:a}=yield Ae(ne,{method:"POST",body:`token=${e}`});if(a)throw a;if(s.interactionEnded(y.SE.VERIFY_TOKEN),yield r.loadNewSession({reason:"memberLogin"}),Se=r.getSmToken(),Ce=e,fe=null!=o?o:yield Oe.getMemberDetails(),yield Promise.all(Object.entries(ke).map((([e,o])=>(0,n.mG)(void 0,void 0,void 0,(function*(){try{if("$$$timeout$$$"===(yield Promise.race([o(),(0,k._v)(3e3).then((()=>"$$$timeout$$$"))])))throw new Error(`callback ${e} timed out`)}catch(e){s.captureError(e,{tags:{feature:"site-members"}})}}))))),i)return t.pages}))},authorizeMemberPagesByCookie(){return(0,n.mG)(this,void 0,void 0,(function*(){const e=(0,p.yF)(c)?{headers:{cookie:`smSession=${N}`}}:void 0,{authorizedPages:o,errorCode:i}=yield Ae(se,e);if(i)throw i;return o}))},authorizeMemberPagesByToken(e){return(0,n.mG)(this,void 0,void 0,(function*(){if(e===N)return this.authorizeMemberPagesByCookie();const{payload:o,errorCode:i}=yield Ae(ne,{method:"POST",body:`token=${e}`});if(i)throw i;const{pages:t}=o;return t}))},authorizeMemberPagesBySignedInstance(e){return(0,n.mG)(this,void 0,void 0,(function*(){const o={headers:{authorization:e}},{authorizedPages:i,errorCode:t}=yield Ae(se,o);if(t)throw t;return i}))},getMemberDetails(e=!1){return(0,n.mG)(this,void 0,void 0,(function*(){if(fe.id&&!e)return fe;if(Se){const o=`/_api/wix-sm-webapp/member/${Se}?collectionId=${O}&metaSiteId=${J}`,{payload:i,errorCode:t}=yield Ae(o);if(t)throw t;return fe=(0,k.Ky)(i),e&&(yield Promise.all(Object.values(Le).map((e=>(0,n.mG)(void 0,void 0,void 0,(function*(){try{yield e()}catch(e){s.captureError(e,{tags:{feature:"site-members"}})}})))))),fe}return null}))},register(e,o,i,t,a,r,l){return(0,n.mG)(this,void 0,void 0,(function*(){r=null!=r&&r;try{s.interactionStarted(y.SE.CODE_SIGNUP),D.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Sign up Submit",eventLabel:"Wix"}});const n={email:e,password:o,profilePrivacyStatus:t,contactInfo:(0,k.t1)(i||{}),defaultFlow:a,recaptchaToken:l},{member:d,approvalToken:u,session:c}=yield Ae("/_api/wix-sm-webapp/v1/auth/signup",{method:"POST",headers:{"Content-Type":"application/json",authorization:x||""},body:JSON.stringify(n)}),m=d.emailVerified,g=null==c?void 0:c.token,p="ACTIVE"===(null==d?void 0:d.status)?"ACTIVE":"PENDING";if(g||m||"ACTIVE"!==d.status){if(a&&"APPLICANT"===(null==d?void 0:d.status)||!g){const o=yield h();return yield Oe.showNotificationDialog("",`${o("siteMembersTranslations","SMApply_Success1","Success! Your member login request has been sent and is awaiting approval.")} ${o("siteMembersTranslations","SMApply_Success2","The site administrator will notify you via email ({0}) once your request has been approved.")}`.replace("{0}",e),o("siteMembersTranslations","SMContainer_OK","OK")),s.interactionEnded(y.SE.CODE_SIGNUP),E["specs.thunderbolt.HangingSignupForNeededApprovalFlow"]?(0,k.Y_)():{member:d,status:p,approvalToken:u}}{const e=yield Oe.applySessionToken(g,d,r);return s.interactionEnded(y.SE.CODE_SIGNUP),D.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Sign up Success",eventLabel:"Wix"}}),D.trackEvent({eventName:"CompleteRegistration",params:{origin:"Site members",method:"Wix"}}),Object.assign({member:d,status:p,sessionToken:g},r&&e?{pages:e}:{})}}return yield Oe.showConfirmationEmailDialog(d.id),s.interactionEnded(y.SE.CODE_SIGNUP),E["specs.thunderbolt.HangingSignupForNeededApprovalFlow"]?(0,k.Y_)():{member:d,status:p}}catch(e){throw D.trackEvent({eventName:"CustomEvent",params:{eventCategory:"Site members",eventAction:"Sign up Failure",eventLabel:"Wix"}}),(0,k.fJ)(e)&&s.interactionEnded(y.SE.CODE_SIGNUP),e}}))},sendForgotPasswordMail(e){return(0,n.mG)(this,void 0,void 0,(function*(){s.interactionStarted(y.SE.RESET_PASSWORD);const o=u.userLanguage,i=encodeURIComponent(Z),t=encodeURIComponent(e),{errorCode:n}=yield Ae("/_api/wix-sm-webapp/member/sendForgotPasswordMail",{method:"POST",body:`returnUrl=${i}&collectionId=${O}&metaSiteId=${J}&lang=${o}&email=${t}`});if(n)throw n;s.interactionEnded(y.SE.RESET_PASSWORD)}))},sendSetPasswordEmail(e,o){return(0,n.mG)(this,void 0,void 0,(function*(){const i=yield Ae("/_api/wix-sm-webapp/members/v1/auth/members/send-set-password-email",{method:"POST",headers:{"Content-Type":"application/json",authorization:x||""},body:JSON.stringify(Object.assign({email:e},(null==o?void 0:o.hideIgnoreMessage)?{hideIgnoreMessage:o.hideIgnoreMessage}:{}))});return!!(null==i?void 0:i.accepted)}))},changePassword(e,o){return(0,n.mG)(this,void 0,void 0,(function*(){const i=encodeURIComponent(e),{errorCode:t}=yield Ae(re,{method:"POST",body:`newPassword=${i}&forgotPasswordToken=${o}`});if(t)throw t}))},resendEmailVerification(e){return(0,n.mG)(this,void 0,void 0,(function*(){const{errorCode:o}=yield Ae(`/_api/wix-sm-webapp/tokens/email/resend/${e}`);if(o)throw o}))},logout(e){return(0,n.mG)(this,void 0,void 0,(function*(){if(Se){if(yield Ae(ae,{method:"POST"}),yield Promise.all(Object.values(Ee).map((e=>(0,n.mG)(void 0,void 0,void 0,(function*(){try{yield e()}catch(e){s.captureError(e,{tags:{feature:"site-members"}})}}))))),e){const o=`./${e.replace(/^\//,"")}`;yield m.navigate(o)}(0,p.yF)(c)||c.document.location.reload()}}))},registerToUserLogin:(e,o=(0,C.uniqueId)("callback"))=>(ke[o]=e,o),unRegisterToUserLogin(e){delete ke[e]},registerToMemberLogout(e){const o=(0,C.uniqueId)("logout_callback");return Ee[o]=e,o},unRegisterToMemberLogout(e){delete Ee[e]},registerToMemberDetailsRefresh(e){const o=(0,C.uniqueId)("mdrcb");return Le[o]=e,o},unRegisterToMemberDetailsRefresh(e){delete Le[e]},showWelcomeDialog(e=!0){return(0,n.mG)(this,void 0,void 0,(function*(){const o={isCloseable:e},i=v.getParsedUrl(),t={onCloseDialogCallback(){Te.closingDialog("WelcomeDialog");const e=new URL(a.requestUrl).hostname,o=0===e.indexOf("www")?e.substr(3):e;I("sm_ef","/",o),F="",Ie.hideDialog(),m.navigate(i.href)},onSubmitCallback(){const e=new URL(a.requestUrl).hostname,o=0===e.indexOf("www")?e.substr(3):e;I("sm_ef","/",o),F="",Ie.hideDialog(),H&&m.navigate("./account/my-account"),m.navigate(i.href)}};Ie.displayDialog("WelcomeDialog",o,t)}))},showNoPermissionsToPageDialog(e){return(0,n.mG)(this,void 0,void 0,(function*(){const o={onCloseDialogCallback(){Ie.hideDialog(),e&&e()},onSwitchAccountLinkClick(){Oe.logout()}};Ie.displayDialog("NoPermissionsToPageDialog",{},o)}))},showResetPasswordDialog(e){return(0,n.mG)(this,void 0,void 0,(function*(){const o={isCloseable:!0,isPolicyLinksSectionVisible:E["specs.thunderbolt.sm_showPolicyLinksResetPasswordDialog"],isTermsOfUseNeeded:!(!(null==me?void 0:me.enabled)||!Y.termsOfUse),isPrivacyPolicyNeeded:!(!(null==ge?void 0:ge.enabled)||!Y.privacyPolicy),termsOfUseLink:Y.termsOfUse,privacyPolicyLink:Y.privacyPolicy},i={onCloseDialogCallback(){Te.closingDialog("ResetPasswordDialog");const e=v.getParsedUrl();e.searchParams.delete("forgotPasswordToken"),e.searchParams.delete("forgotPasswordLang"),v.pushUrlState(e),Ie.hideDialog(),m.navigate(e.href)},onSubmitCallback(i){return(0,n.mG)(this,void 0,void 0,(function*(){const t=yield h();try{yield Oe.changePassword(i,e),Oe.showNotificationDialog(t("siteMembersTranslations","siteMembersTranslations_Reset_Password_Sucess_Title","Your password has been changed."),"",t("siteMembersTranslations","SMContainer_OK","OK"),(()=>(0,n.mG)(this,void 0,void 0,(function*(){const e=v.getParsedUrl();e.searchParams.delete("forgotPasswordToken"),e.searchParams.delete("forgotPasswordLang"),v.pushUrlState(e),yield Oe.showLoginDialog(),m.navigate(e.href)}))))}catch(e){if(-19972!==e)throw e;Oe.showNotificationDialog(t("siteMembersTranslations","siteMembersTranslations_PASSWORD_HAS_EXPIRED_TITLE","Your link to create a new password has expired"),t("siteMembersTranslations","siteMembersTranslations_PASSWORD_HAS_EXPIRED_TEXT","To continue, resend a new link to your email."),t("siteMembersTranslations","siteMembersTranslations_PASSWORD_HAS_EXPIRED_OK","Resend Link"),(()=>Oe.promptForgotPassword(o.isCloseable).then((()=>{const e=v.getParsedUrl();m.navigate(e.href)}))))}}))}};Ie.displayDialog("ResetPasswordDialog",o,i,Pe())}))},showLoginDialog(e=!0,o="fullscreen",i=!1){return(0,n.mG)(this,void 0,void 0,(function*(){return ve&&(null==f?void 0:f.isPopupPage(ve))?Oe.showCustomAuthenticationDialog(ve,i):new Promise(((t,a)=>(0,n.mG)(this,void 0,void 0,(function*(){_e.assignRequestAuthenticationRejection(a);const n={bsi:Me,displayMode:o,language:u.userLanguage,directionByLanguage:u.directionByLanguage,isCloseable:e,smCollectionId:O,svSession:W,biVisitorId:B,metaSiteId:J,isSocialLoginGoogleEnabled:ce,isSocialLoginFacebookEnabled:!q&&ue,isEmailLoginEnabled:!q,isSocialAuthSupported:ie,useGoogleSdk:Re},r={onCloseDialogCallback(){Ie.hideDialog(),Te.closingDialog("MemberLoginDialog",o),_e.rejectAuthenticationRequest()},submit:(e,n,a)=>(s.interactionStarted(y.SE.DEFAULT_LOGIN),Te.emailAuthSubmitClicked("MemberLoginDialog",o),Oe.login(e,n,a,i).then((e=>{s.interactionEnded(y.SE.DEFAULT_LOGIN),Ie.hideDialog(),t(e)})).catch((e=>{throw(0,k.Y2)(e)&&s.interactionEnded(y.SE.DEFAULT_LOGIN),e}))),onForgetYourPasswordClick(){Oe.promptForgotPassword(e)},onSwitchDialogLinkClick(){Oe.showSignUpDialog(e,o,i).then(t,(()=>{_e.rejectAuthenticationRequest()}))},onTokenMessage(e,o,n=!1){let s;return G&&(s=n?"PUBLIC":"PRIVATE"),Oe.handleOauthToken(e,o,"memberLoginDialog",s,i).then((e=>{Ie.hideDialog(),t(e)}))},onBackendSocialLogin:(e,o)=>Oe.handleSocialLoginResponse(e,o,i).then((e=>{Ie.hideDialog(),t(e)})),getHostReadyPayload:()=>({visitorId:B,svSession:W})};Te.loginOrSignUpDialogLoaded("MemberLoginDialog",o),yield Ie.displayDialog("MemberLoginDialog",n,r,Pe()),Oe.closeCustomAuthenticationDialogs(!0)}))))}))},showSignUpDialog(e=!0,o="fullscreen",i=!1){return(0,n.mG)(this,void 0,void 0,(function*(){return he&&(null==f?void 0:f.isPopupPage(he))?Oe.showCustomAuthenticationDialog(he,i):new Promise(((t,a)=>(0,n.mG)(this,void 0,void 0,(function*(){_e.assignRequestAuthenticationRejection(a);const n={bsi:Me,displayMode:o,language:u.userLanguage,directionByLanguage:u.directionByLanguage,isCloseable:e,smCollectionId:O,biVisitorId:B,svSession:W,metaSiteId:J,isSocialLoginGoogleEnabled:ce,isSocialLoginFacebookEnabled:!q&&ue,isSocialAuthSupported:ie,isEmailLoginEnabled:!q,isCommunityInstalled:G,joinCommunityCheckedByDefault:be,isTermsOfUseNeeded:!(!(null==me?void 0:me.enabled)||!Y.termsOfUse),isPrivacyPolicyNeeded:!(!(null==ge?void 0:ge.enabled)||!Y.privacyPolicy),isCodeOfConductNeeded:!(!(null==pe?void 0:pe.enabled)||!Y.codeOfConduct),termsOfUseLink:Y.termsOfUse,privacyPolicyLink:Y.privacyPolicy,codeOfConductLink:Y.codeOfConduct,useGoogleSdk:Re},r={onCloseDialogCallback(){Ie.hideDialog(),Te.closingDialog("SignUpDialog",o),_e.rejectAuthenticationRequest()},submit(e,n,a){let r;if(G){r=("boolean"==typeof a?a:a.isCommunityChecked)?y.iY.PUBLIC:y.iY.PRIVATE}const l="boolean"==typeof a||null==a?void 0:a.recaptchaToken;return s.interactionStarted(y.SE.DEFAULT_SIGNUP),Te.emailAuthSubmitClicked("SignUpDialog",o),Oe.register(e,n,void 0,r,void 0,i,l).then((e=>{s.interactionEnded(y.SE.DEFAULT_SIGNUP);const{member:o,sessionToken:n,pages:a}=e;n&&(Ie.hideDialog(),t(Object.assign({member:o,sessionToken:n},i?{pages:a}:{})))})).catch((e=>{throw(0,k.fJ)(e)&&s.interactionEnded(y.SE.DEFAULT_SIGNUP),e}))},onSwitchDialogLinkClick(){Oe.showLoginDialog(e,o,i).then(t,(()=>{_e.rejectAuthenticationRequest()}))},onTokenMessage(e,o,n=!1){let s;return G&&(s=n?"PUBLIC":"PRIVATE"),Oe.handleOauthToken(e,o,"memberLoginDialog",s,i).then((e=>{Ie.hideDialog(),t(e)}))},onBackendSocialLogin:(e,o)=>Oe.handleSocialLoginResponse(e,o,i).then((e=>{Ie.hideDialog(),t(e)})),getHostReadyPayload:()=>({visitorId:B,svSession:W})};Te.loginOrSignUpDialogLoaded("SignUpDialog",o),yield Ie.displayDialog("SignUpDialog",n,r,Pe()),Oe.closeCustomAuthenticationDialogs(!0)}))))}))},showNotificationDialog(e,o,i,t=(()=>0),s=(()=>0)){return(0,n.mG)(this,void 0,void 0,(function*(){const n={isCloseable:!0,title:e,description:o,okButtonText:i},a={onCloseDialogCallback(){Te.closingDialog("NotificationDialog"),Ie.hideDialog(),s()},onOkButtonClick(){Ie.hideDialog(),t()}};yield Ie.displayDialog("NotificationDialog",n,a)}))},showConfirmationEmailDialog(e,o=!0){return(0,n.mG)(this,void 0,void 0,(function*(){const i={isCloseable:!0,isSignUp:o},t={onCloseDialogCallback(){Te.closingDialog("ConfirmationEmailDialog"),Ie.hideDialog()},onResendConfirmationEmail(){return(0,n.mG)(this,void 0,void 0,(function*(){yield Oe.resendEmailVerification(e),yield Oe.showConfirmationEmailDialog(e,!1)}))}};yield Ie.displayDialog("ConfirmationEmailDialog",i,t)}))},showCustomAuthenticationDialog(e,o=!1){return(0,n.mG)(this,void 0,void 0,(function*(){if(!f)throw new Error("popup unavailable");return new Promise(((i,t)=>(0,n.mG)(this,void 0,void 0,(function*(){_e.assignRequestAuthenticationResolveInstance(i),_e.assignRequestAuthenticationRejection(t);const s=Oe.registerToUserLogin((()=>(0,n.mG)(this,void 0,void 0,(function*(){_e.requestAuthenticationResolveInstance(Object.assign({member:fe,sessionToken:Ce},o?{pages:yield Oe.authorizeMemberPagesBySignedInstance(Se)}:{})),Oe.unRegisterToUserLogin(s),f.getCurrentPopupId()===e&&f.closePopupPage()}))),"customAuthCbId");yield _e.openPopupPage(e,(()=>{Oe.unRegisterToUserLogin(s)})),Ie.hideDialog()}))))}))},closeCustomAuthenticationDialogs(e=!1){return(0,n.mG)(this,void 0,void 0,(function*(){const o=null==f?void 0:f.getCurrentPopupId();o&&[he,ve].includes(o)&&(e&&_e.preventCustomPopupCloseCallback(),yield f.closePopupPage(),_e.allowCustomPopupCloseCallback())}))},getForgotPasswordToken:()=>new URL((0,p.yF)(c)?a.requestUrl:location.href).searchParams.get("forgotPasswordToken"),shouldDisplayWelcomeDialog:()=>F&&H,appWillMount(){switch(new URL(a.requestUrl).searchParams.get("showDialog")){case"MemberLoginDialog":Oe.showLoginDialog();break;case"SignUpDialog":Oe.showSignUpDialog();break;case"RequestPasswordResetDialog":Oe.promptForgotPassword();break;case"ResetPasswordDialog":Oe.showResetPasswordDialog("faketoken");break;case"WelcomeDialog":Oe.showWelcomeDialog();break;case"NoPermissionsToPageDialog":Oe.showNoPermissionsToPageDialog();break;case"NotificationDialog":Oe.showNotificationDialog("title","description","ok");break;case"ConfirmationEmailDialog":Oe.showConfirmationEmailDialog("fakemember")}},pageWillUnmount({pageId:e}){[he,ve].includes(e)||Ie.hideDialog()},getSocialAuthComponentProps:()=>(0,k.IO)({config:e,viewerModel:a,sessionManager:r,bsiManager:L,handleOauthToken:Oe.handleOauthToken,handleSocialLoginResponse:Oe.handleSocialLoginResponse,isSocialAuthSupported:te})};return i.update((()=>({shouldShowRenderingBlockingDialogs:()=>!(!Oe.getForgotPasswordToken()&&!Oe.shouldDisplayWelcomeDialog()),showRenderingBlockingDialogs:()=>{const e=Oe.getForgotPasswordToken();return e?Oe.showResetPasswordDialog(e):Oe.shouldDisplayWelcomeDialog()?Oe.showWelcomeDialog():void 0}}))),Oe}));var _=i(59032),M=i(95793),O=i(81600);const N=(0,t.ff)([w.n9],(e=>({getTpaHandlers(){const o=(o,i,t)=>(0,n.mG)(this,void 0,void 0,(function*(){var o,i,n;const s=yield e.getMemberDetails();return s?(null===(o=t.appClientSpecMapData)||void 0===o?void 0:o.isWixTPA)?{attributes:{firstName:null!==(i=s.firstName)&&void 0!==i?i:"",lastName:null!==(n=s.lastName)&&void 0!==n?n:"",privacyStatus:s.profilePrivacyStatus},name:s.memberName,email:s.loginEmail,id:s.id,owner:s.owner,status:s.status}:{id:s.id,owner:s.owner,status:s.status}:null})),i=(o,i={})=>(0,n.mG)(this,void 0,void 0,(function*(){var o,t;const{member:n}=yield e.promptLogin({mode:i.mode,modal:i.modal});return{attributes:{firstName:null!==(o=n.firstName)&&void 0!==o?o:"",lastName:null!==(t=n.lastName)&&void 0!==t?t:"",privacyStatus:n.profilePrivacyStatus},name:n.memberName,email:n.loginEmail,id:n.id,owner:n.owner,status:n.status}}));return{currentMember:o,smCurrentMember:o,logOutCurrentMember:(0,O.u)(["site"],((o,i)=>{e.logout(null==i?void 0:i.url)})),requestLogin:(0,O.u)(["site"],i),smRequestLogin:(0,O.u)(["site"],i)}}}))),U=(0,t.ff)([w.n9,(0,t.t6)(s.$e,w.u2),l.xP],((e,{componentIds:o},i)=>({pageWillMount(){return(0,n.mG)(this,void 0,void 0,(function*(){const t=o.reduce(((o,i)=>{const t=e.getSocialAuthComponentProps();return Object.assign(Object.assign({},o),{[i]:t})}),{});i.update(t)}))}}))),G=(0,t.ff)([(0,t.t6)(s.Wf,w.u2)],(e=>({handle:o=>(0,n.mG)(void 0,void 0,void 0,(function*(){const{shouldShowRenderingBlockingDialogs:i,showRenderingBlockingDialogs:t}=e.get();return i()?(t(),null):o}))}))),$=e=>{e(w.n9,_.j.AppWillMountHandler,_.j.AppDidMountHandler).to(R),e(v.BD.BlockingDialogs).to(G)},j=e=>{e(M.g).to(N),e(_.j.PageWillMountHandler).to(U),e(_.j.PageWillUnmountHandler).to((0,t.ff)([w.n9],(e=>({pageWillUnmount:o=>e.pageWillUnmount(o)}))))}}}]);
//# sourceMappingURL=https://static.parastorage.com/services/wix-thunderbolt/dist/siteMembers.c67acd40.chunk.min.js.map